{% extends "base.html" %}
{% block title %}Send Notification{% endblock %}

{% block content %}

<h2>Send Notification</h2>

<form method="POST" action="{{ url_for('admin_bp.send_notification') }}">

    <label>
        <input type="checkbox" name="send_all" value="1" id="send_all_toggle">
        Send to ALL users
    </label>

    <br><br>

    <div id="single_user_select">
        <label>User</label>
        <select name="user_id">
            {% for user in users %}
                <option value="{{ user.id }}">
                    {{ user.name }} ({{ user.email }})
                </option>
            {% endfor %}
        </select>
    </div>

    <br>

    <label>Title</label>
    <input type="text" name="title" required>

    <br><br>

    <label>Message</label>
    <textarea name="message" required></textarea>

    <br><br>

    <label>Link (optional)</label>
    <input type="text" name="link" placeholder="/dashboard">

    <br><br>

    <label>
        <input type="checkbox" name="is_critical" value="1">
        Critical (Email if offline)
    </label>

    <br><br>

    <button type="submit">Send Notification</button>

</form>

<script>
document.getElementById("send_all_toggle").addEventListener("change", function() {
    document.getElementById("single_user_select").style.display =
        this.checked ? "none" : "block";
});
</script>

{% endblock %}